<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Delay-Doppler Domain Signaling and OTFS | Lizhong Zheng </title> <meta name="author" content="Lizhong Zheng"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://lizhongzheng.github.io/blog/2025/OTFS/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Lizhong</span> Zheng </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item "> <a class="nav-link" href="/people/">people </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Delay-Doppler Domain Signaling and OTFS</h1> <p class="post-meta"> Created in January 06, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/wireless-communication"> <i class="fa-solid fa-hashtag fa-sm"></i> wireless-communication</a>   ·   <a href="/blog/category/wireless-communication"> <i class="fa-solid fa-tag fa-sm"></i> Wireless-Communication</a> </p> </header> <article class="post-content"> <div id="table-of-contents"> <ul id="toc" class="section-nav"> <li class="toc-entry toc-h2"><a href="#the-high-level-reasons-for-otfs">The High Level Reasons for OTFS</a></li> <li class="toc-entry toc-h2"><a href="#time-frequency-domain-representation">Time-Frequency Domain Representation</a></li> <li class="toc-entry toc-h2"> <a href="#zak-transform">Zak Transform</a> <ul> <li class="toc-entry toc-h3"><a href="#functional-basis-from-zak-transform">Functional Basis from Zak Transform</a></li> <li class="toc-entry toc-h3"><a href="#time-and-frequency-limits-and-degrees-of-freedom">Time and Frequency Limits and Degrees of Freedom</a></li> </ul> </li> <li class="toc-entry toc-h2"> <a href="#the-construction-of-the-otfs-modulation">The Construction of the OTFS Modulation</a> <ul> <li class="toc-entry toc-h3"><a href="#otfs-modulation">OTFS Modulation</a></li> </ul> </li> <li class="toc-entry toc-h2"><a href="#the-sparsity-in-dd-domain-a-numerical-experiment">The Sparsity in DD-Domain, a Numerical Experiment</a></li> </ul> </div> <hr> <div id="markdown-content"> <h2 id="the-high-level-reasons-for-otfs">The High Level Reasons for OTFS</h2> <p>OTFS stands for “Orthogonal Time Frequency Space”, which is a modulation method proposed around 2016 as an alternative modulation scheme. It aims to replace or partially replace the current OFDM modulation. The point is that OFDM modulates information-carrying symbols on different sub-carriers with different frequencies. In a multi-path environment with high mobility, each received version of these frequency components has a Doppler shift as the reflectors move. This causes the symbol on one sub-carrier to have an “echo” on different sub-carriers, hence interference with the symbols on those sub-carriers. It is generally known that OFDM is vulnerable to severe Doppler shift. When the Doppler shift is comparable to sub-carrier spacing, there can be significant inter-symbol interference.</p> <p>For example, an LTE system might have a carrier frequency of \(f_c = 3.5\) GHz and sub-carrier spacing of \(15\) kHz. If a mobile receiver moves at \(v=180\) km/h, the Doppler shift can be up to</p> \[f_c \cdot \frac{v}{c} = 3.5 \cdot 10^9 (\text{Hz}) \cdot \frac{180 \cdot 10^3 (\text{m/h})}{3600 (\text{s/h}) \cdot 3 \cdot 10^8 (\text{m/s})} \approx 0.6 (\text{kHz}),\] <p>which is not a negligible amount. This worsens when we use higher carrier frequencies in the tens of GHz range and when mobile devices move at a higher speed, such as in high-speed trains or drones. The situation is bad not because of the one-on-one inter-sub-carrier interference but because one symbol can interfere with a consecutive group of sub-carriers.</p> <p>The delay-doppler domain signal representation can be viewed as an alternative set of basis functions. The promise is that if there is a single reflector with a fixed delay \(\tau\) and moves at a fixed speed corresponding to a fixed Doppler shift \(\nu\), then <strong>the signal on one of the basis functions is simply moved to a single different basis function</strong>. Now, since there are only a few such reflectors and they move at a manageable speed (not multiplied by the carrier frequency or the speed of light), the result is a fixed and sparse inter-symbol-interference pattern. This makes OTFS modulation particularly easy for equalization in high mobility environments.</p> <p>The point of this tutorial is to derive this new set of basis functions and compare that with the normal OFDM basis. This serves as a baseline for our future development of 2-D filter for equalization in OTFS systems.</p> <h2 id="time-frequency-domain-representation">Time-Frequency Domain Representation</h2> <p>For the purpose of comparison, we write out the standard time-frequency representation of signals, which is the foundation of the OFDM modulation and closely related to OTFS.</p> <p>To start with, we quote the well-known sampling theory. For \(x_0(t)\) that is band limited to \(\left(-\frac{\Delta f}{2}, \frac{\Delta f}{2} \right)\), we know we can reconstruct with samples with interval \(T = \frac{1}{\Delta f}\).</p> \[x[n, m=0] = x_0(t) \big | _{t = n T}\] <p>That is, we can write</p> \[x_0(t) = \sum_n x[n, 0] \cdot \mathrm{sinc}\left(\frac{\pi (t -nT) }{T} \right)\] <p>Now recall the aliasing effect, an arbitrary signal \(x(t)\) can always be written as</p> \[x(t) = \sum_m x_m(t), \qquad \forall t\] <p>where each \(x_m(t)\) is limited to the band \(((m-\frac{1}{2} )\Delta f, (m+\frac{1}{2}) \Delta f)\), and a corresponding sampling theorem:</p> \[x_m(t) = \sum_n x[n,m] \cdot \mathrm{sinc}\left( \frac{\pi (t-nT)}{T}\right) \cdot e^{j 2 \pi m \frac{t}{T}}, \quad \forall t\] <p>This basically says that the modulated sinc functions are a complete set of basis functions. Here, we use the superscript “TF” for basis functions in the time-frequency (TF) domain.</p> \[\begin{aligned} \phi^{\mathsf{TF}}_{m,n}(t) &amp;\stackrel{\Delta}{=} \mathrm{sinc}\left( \frac{\pi (t-nT)}{T} \right) \cdot e^{j 2\pi m\frac{t}{T}}, \quad \forall t, m, n \end{aligned}\] <p>and write the following as a representation of an arbitrary signal \(x(t)\), or a way to modulate symbols \(x[m,n]\) on a waveform.</p> \[\begin{aligned} x(t) &amp;= \sum_{m,n} x[m,n] \cdot \phi^{\mathsf{TF}}_{m,n}(t) \end{aligned}\] <p>We will see that OTFS is just a different set of basis functions in the delay-Doppler (DD) domain for which the channel response of a multi-path doppler wireless channel is sparse. The key concept for this construction is the <a href="https://en.wikipedia.org/wiki/Zak_transform" rel="external nofollow noopener" target="_blank">Zak Transform</a>.</p> <h2 id="zak-transform">Zak Transform</h2> <hr> <dl> <dt>Definition: Zak Transform</dt> <dd>For a complex continuous waveform \(x(t)\) and a fixed \(T&gt;0\) and \(\Delta f = 1/T\), the Zak transform is</dd> </dl> \[Z_x(\tau, \nu) \stackrel{\Delta}{=} \sqrt{T} \sum_{k=-\infty}^\infty x(\tau + kT) \cdot e^{-j2\pi k\nu T}\] <hr> <p><br></p> <p><strong>Property 1: Linearity</strong></p> \[Z_{a x+ b y} (\tau, \nu) = a \cdot Z_x(\tau, \nu) + b \cdot Z_y(\tau, \nu)\] <p><strong>Property 2: Periodicity in Doppler and Quasi-Periodicity in Delay</strong></p> <p>For all integers \(n, m\):</p> \[\begin{align*} Z_x (\tau, \nu + m \Delta f) &amp;= Z_x (\tau, \nu)\\ Z_x (\tau + nT , \nu) &amp; = Z_x(\tau, \nu) \cdot e^{j2\pi n \nu T} \end{align*}\] <p>These two ban both be derived by directly plugging in the definition.</p> <p><strong>Property 3: Inverse Transform</strong></p> \[x(t) = \sqrt{T} \int_0^{\Delta f} Z_x(t, \nu) \; d \nu\] <details><summary>Proof of Property 3</summary> \[\begin{align*} &amp;\sqrt{T} \int_0^{\Delta f} Z_x(t, \nu) \; d \nu \\ &amp;= \sqrt{T} \int_0^{\Delta f} \left(\sqrt{T} \sum_{k=-\infty}^\infty x(t + kT) \cdot e^{-j2\pi k\nu T} \right) \;d \nu\\ &amp;= T \sum_{k=-\infty}^\infty X(t+ kT) \cdot \left(\int_0^{\frac{1}{T}} e^{-j 2\pi k \nu T} \; d \nu \right)\\ &amp;= T \sum_{k=-\infty}^\infty X(t+ kT) \cdot \left(\frac{1}{T} \cdot \delta(k)\right) \\ &amp; = x(t) \end{align*}\] </details> <p><br></p> <p><strong>Property 4: Fourier Transform</strong></p> \[\mathcal F_x (f) =\frac{1}{\sqrt{T}} \int_0^T Z_x(\tau, f) e^{-j2\pi f \tau} \; d\tau\] <details><summary>Proof for Property 4:</summary> \[\begin{align*} &amp; \frac{1}{\sqrt{T}} \int_0^T Z_x(\tau, f)\cdot e^{-j2\pi f \tau} \; d\tau\\ &amp;= \frac{1}{\sqrt{T}} \int_0^T \left( \sqrt{T} \sum_{k=-\infty}^\infty x(\tau + kT) \cdot e^{-j2\pi kf T}\right) \cdot e^{-j 2\pi f \tau} \; d \tau\\ &amp;= \int_0^T \sum_{k=-\infty}^\infty x(\tau + kT) \cdot e^{-j 2\pi f(\tau + kT)} \; d\tau\\ &amp;= \int_{-\infty}^\infty x(t) \cdot e^{-j2\pi f t} \; dt\\ &amp;= \mathcal F_x(f) \end{align*}\] </details> <p><br></p> <p><strong>Property 5: Delay and Frequency Shift</strong></p> <p>If \(r(t) = x(t-\tau_0), \forall t\), then</p> \[Z_r(\tau, \nu) = Z_x(\tau - \tau_0, \nu)\] <p>If \(r(t) = x(t) e^{j2\pi \nu_0 t}, \forall t\), then</p> \[Z_r(\tau, \nu) = Z_x(\tau , \nu-\nu_0) \cdot e^{j2\pi \nu_0 \tau}\] <p>If there is a single reflector with delay \(\tau_0\) and Doppler shift \(\nu_0\), i.e. the received signal</p> \[r(t) = x(t-\tau_0) \cdot e^{j 2\pi \nu_0(t-\tau_0)}\] <p>Then in Zak representation</p> \[Z_r(\tau, \nu) = Z_x(\tau - \tau_0, \nu - \nu_0) \cdot e^{j 2\pi \nu_0 (\tau-\tau_0)}\] <p><br></p> <p><strong>Property 6: Convolution and Product</strong></p> <p>If \(a(t)\) and \(b(t)\) have Zak transform of \(Z_a(\tau, \nu), Z_b(\tau, \nu)\), resp., and define</p> \[\begin{align*} c(t) &amp;= \int_{-\infty}^\infty a(t') \cdot b(t-t')\; dt'\\ d(t) &amp;= a(t)\cdot b(t) \end{align*}\] <p>Then</p> \[\begin{align*} Z_c(\tau, \nu) &amp;= \frac{1}{T} \int_0^T Z_a(\tau - \tau', \nu) \cdot Z_b(\tau', \nu) \; d\tau'\\ Z_d(\tau, \nu)&amp;= \sqrt{T} \int_0^{\Delta f} Z_a(\tau, \nu-\nu') \cdot Z_b(\tau, \nu') \; d\nu' \end{align*}\] <p><br></p> <h3 id="functional-basis-from-zak-transform">Functional Basis from Zak Transform</h3> <p>We are now ready to define the Zak Transform, in a similar way that Fourier Transform is defined, for continuous time signal \(x(t), t \in \mathbb R\).</p> <hr> <dl> <dt>Theorem: Zak Transform and Inverse</dt> <dd>For a complex continuous waveform \(x(t)\) and a fixed \(T&gt;0\) and \(\Delta f = 1/T\), define for each \(\tau_0 \in [0, T), \nu_0 \in [0, \Delta f)\),</dd> </dl> \[\begin{align*} p_{(\tau_0, \nu_0)} (t) \stackrel{\Delta}{=} \sqrt{T} \cdot \sum_{k = -\infty}^\infty e^{j2\pi \nu_0 k T} \cdot \delta(t-\tau_0 -kT) \end{align*}\] <p>The Zak Transform can be written by sampling \(x(t)\) with the above impulse train:</p> \[Z_x(\tau_0, \nu_0) = \int_{-\infty}^\infty x(t) \cdot p^*_{(\tau_0, \nu_0)}(t) \; dt\] <p>Inversely, we have</p> \[x(t) = \int_0^T \int_0^{\Delta f} Z_x(\tau_0, \nu_0) \cdot p_{(\tau_0, \nu_0)} (t) \; d\nu_0 d\tau_0\] <p>Each \(p_{(\tau_0, \nu_0)}(t)\) is called a <strong>Zak Basis Function</strong>.</p> <hr> <p><strong>Remarks:</strong></p> <details><summary>1.Comparison to Fourier Transform (FT)</summary> <p>In Fourier Transform, we also have each complex exponential as a “Fourier Basis Function”:</p> \[p_f(t) = e^{j 2\pi f t}\] <p>The inverse FT can be thought as writing \(x(t)\) as linear combinations of the basis functions:</p> \[x(t) = \int_{-\infty}^\infty \mathcal{F}\_x(f) \cdot p_f(t) \; df\] <p>The forward FT can be thought as making projection to find, for \(x(t)\), the coefficient on each basis function</p> \[\mathcal {F}_X(f) = \int_{t=-\infty}^\infty x(t) \cdot p^*_f(t) \; dt\] <p>There is a clear parallelism.</p> <p><br></p> </details> <details><summary>2.A Delay-Doppler Domain View of the Basis Functions</summary> <p><br> One can easily check that the Zak transform of a basis function $p_{(\tau_0, \nu_0)}(t)$ is</p> \[Z_{p_{(\tau_0, \nu_0)}} (\tau, \nu) = \sum_{m=-\infty}^\infty \sum_{n=-\infty}^\infty \delta (\tau - \tau_0 - nT) \cdot \delta (\nu - \nu_0 - m \Delta f) \cdot e^{j2\pi \nu_0 n T}\] <p>This is the impulse train that satisfies both the properties of periodicity in Doppler and quasi-periodicity in delay. There a a continuum of basis functions here for $\tau_0 \in [0, T), \nu_0 \in [0, \Delta f)$, corresponding to the uncountably many dimensions in the space of general functions. <br></p> </details> <details><summary>3.A Channel in Delay-Doppler (DD) Domain</summary> <p><br> A key assumption is that a wireless channel can be written in the DD domain as</p> \[h(\tau, \nu) = \sum_j h_j \cdot \delta(\tau -\tau_j) \cdot \delta(\nu - \nu_j)\] <p>where the sum is over multi-paths. When using this channel model directly in the DD domain, one would convolve $h(\tau, \nu)$ with $Z_x(\tau, \nu)$ in both the delay and the Doppler shift.</p> <p>The key assumption is that there are a very limited number of multi-path, which makes the channel sparse in the DD domain. The same channel represented in the TF domain would be no so sparse.</p> <p><br></p> </details> <p><br></p> <h3 id="time-and-frequency-limits-and-degrees-of-freedom">Time and Frequency Limits and Degrees of Freedom</h3> <p>Different from the time-frequency domain representation, which is naturally related to the bandwidth limit and time limit in signal transmissions, the delay-Doppler domain representation does not give rise to the functional basis that is limited in the time or frequency domain. This can be seen from the fact that \(p_{(\tau_0, \nu_0)}(t)\) defined above is neither time or frequency limited. We need to implement these limits in a separate step that appears different from the TF domain treatment.</p> <p>One can think of the parameters \(T\) and \(\Delta f = 1/T\) in the the definition of the Zak transform as a single degree of freedom. In a spread-spectrum system, we often need to consider multiplexing many lines of data in a collection of degrees of freedoms. Here, we consider this collection as signals that are time limited in \(t \in [0, NT)\) and frequency limited in \(f \in [0, M \cdot \Delta f)\). For convenience, we call this space of waveforms \(\Omega(NT, M \Delta f)\).</p> <p><strong>Remark:</strong> To be precise, there is no such a waveform that is perfectly time limited and band limited. The notion of limitation here is an approximation, which gets more precise in the L2 sense as \(M\cdot N\to \infty\). This is a standard procedure in the development of Fourier Transform. <a href="https://www.mit.edu/~6.450/handouts/6.450book.pdf" rel="external nofollow noopener" target="_blank">Gallager’s book</a> chapter 4 is a good reference for this topic, among many others.</p> <details><summary>We have a brief summary of those treatment here.</summary> <p><br> Here, we use the normalize Sinc function as</p> \[\mathrm{sinc}(t) \stackrel{\Delta}{=} \frac{\sin(\pi t)}{\pi t}\] <p>and the T-F Fourier Transform, not in \(\omega\):</p> \[{\mathcal F}_x(f) \stackrel{\Delta}{=} \int_{-\infty}^\infty x(t) \cdot e^{-j2\pi f t} \; dt\] <p>This gives the easy Fourier Transform pair of \(\mathrm{sinc}(at) \leftrightarrow \frac{1}{a} \mathrm{rect}\left(\frac{f}{a} \right),\) where \(\mathrm{rect}(t/a) = 1\) if \(t \in (-a/2, a/2).\)</p> <p><br></p> <p>Now, consider sampling \(x(t)\) with interval \(T_s\), or sampling frequency of \(F_s = 1/T_s\).</p> \[x(t) = \sum_{n=-\infty}^\infty x[n] \cdot \mathrm{sinc}\left(\frac{t-n T_s}{T_s}\right)\] <p>We know that this equation holds only for band-limited \(x(t)\), with \(\mathcal F_x(f) \neq 0\) only on \(f \in [-\frac{1}{2}F_s, \frac{1}{2}F_s]\), i.e.</p> \[\mathcal F_x(f) = \mathcal F_x(f) \cdot \mathrm{rect} \left(\frac{ f}{F_s}\right).\] <p>We call \(W = \frac{1}{2} F_s\), the bandwidth of the waveform \(x(t)\). Now to specify this waveform within a time window of \(t \in [0, T]\), we need to specify all the samples within the window</p> \[x[n] = x(t) \big|_{t=nT_s} : nT_s \in [0, T]\] <p>or equivalently \(n = 0, 1, \ldots \frac{T}{T_s} = 2WT\); and we should think of the out-of-window part of the signal, \(x(t), t \not\in [0, t]\) as small, with a vanishing power.</p> <p><br></p> <p>As an alternative way to write the same waveform as linear combination of basis functions, we can consider dividing the entire bandwidth into \(M\) sub-bands. That is</p> \[x(t) = \sum_{m=0}^{M-1} x_m(t) \cdot e^{j 2\pi (\frac{2m+1}{2M}-\frac{1}{2}) F_s t}\] <p>where each \(x_m(t)\) is the baseband signal occupies \(\frac{1}{m}\) of the total bandwidth, \([-\frac{1}{2M} F_s, \frac{1}{2M} F_s]\), modulated with \(e^{j 2\pi (\frac{2m+1}{2M}-\frac{1}{2}) F_s t}\). Each \(x_m(t)\) can be written from its samples at a sampling rate of \(F_s/M\) as</p> \[x_m(t) = \sum_{n=0}^{N-1} x[m,n] \cdot \mathrm{sinc}\left( \frac{t - n M T_s }{MT_s}\right)\] <p>where to cover a time window of \(T\), we need \(N = \frac{T}{MT_s}\). The overall waveform can be written as</p> \[\begin{align*} x(t) &amp;= \sum_{n=0}^{N-1} \sum_{m=0}^{M-1} x[m,n] \cdot \phi_{m,n}(t)\\ &amp;= \sum_{n=0}^{N-1} \sum_{m=0}^{M-1} x[m,n] \cdot \mathrm{sinc}\left( \frac{t - n M T_s }{MT_s}\right) e^{j 2\pi (\frac{2m+1}{2M}-\frac{1}{2}) F_s t} \end{align*}\] <p>which defines the basis functions \(\phi_{m,n}\) as the modulated sinc functions. There are \(M\cdot N = \frac{T}{T_s} = 2WT\) such basis functions. Gallager calls these basis function “Sinc-Weighted Sinusoid Functions”.</p> </details> <hr> <p>Our next step is to construct a set of ortho-normal basis for the space time and frequency limited signals \(\Omega(NT, M\Delta f)\). This can be done in a bruteforce way: we can take the set of ortho-normal basis functions \(\{p_{(\tau_0, \nu_0)}(t), \tau_0 \in [0, T), \nu_0 \in [0, \Delta f)\}\) defined in Theorem 1, truncate each of them in both time and frequency, and then pick out a finite number of orthogonal ones.</p> <p>For the truncation, we use the following two functions defined as rectangles in time and frequency, resp.:</p> \[\begin{align*} q(t) &amp;\stackrel{\Delta}{=} \begin{cases}1 &amp; t \in [0, NT)\\ 0 &amp;\mbox{otherwise}\end{cases}\\\\ {\mathcal F}_s(f) &amp;\stackrel{\Delta}{=} \begin{cases}1 &amp; f \in [0, M \Delta f)\\ 0 &amp;\mbox{otherwise}\end{cases}\\\\ s(t) &amp;= M \Delta f \cdot \mathrm{sinc}(M\Delta f \cdot t)\cdot e^{j 2\pi \frac{M \Delta f}{2} t} \end{align*}\] <p>Now we use these two functions to truncate the basis functions as</p> <hr> <dl> <dt>Definition:</dt> <dd> <p>For each \(\tau_0 \in [0, T), \nu_0 \in [0, \Delta f)\), the truncated basis function of \(\Omega(NT, M\Delta f)\) is</p> </dd> </dl> \[\psi_{(\tau_0, \nu_0)}(t) \stackrel{\Delta}{=} (p_{(\tau_0, \nu_0)}(t) \cdot q(t) ) * s(t) = \sqrt{T} \cdot \sum_{n=0}^{N-1}s(t - \tau_0 - nT) \cdot e^{j 2\pi \nu_0 nT}\] <p>for each \(p_{(\tau_0, \nu_0)}\) defined in Theorem 1.</p> <hr> <p>The next step is to select a subset of orthogonal basis functions. To do that, we simply do even sampling on \([0, NT] \times [0, M\Delta f]\).</p> <dl> <dt>Definition: DD-Domain Basis for \(\Omega (NT, M\Delta f)\)</dt> <dd> <p>For \(k = 0, 1, \ldots, N-1, l = 0, 1, \ldots, M-1\)</p> </dd> </dl> \[\alpha_{(k,l)} (t) \stackrel{\Delta}{=} \frac{1}{\sqrt{MN}} \cdot \psi_{(\tau_0, \nu_0)}(t) \Big|_{\tau_0 = \frac{l}{M}T, \nu_0 = \frac{k}{N}\Delta f}\] <hr> <p>Now all we need to verify is that these constructed basis functions are indeed ortho-normal.</p> <dl> <dt>Theorem: Orthonormal Basis</dt> <dd>The basis defined above is an \(MN\)-dimensional ortho-normal basis. That is</dd> </dl> \[\displaystyle \int_{-\infty}^\infty \alpha_{(k, l)}(t) \cdot \alpha^\dagger_{(k', l')}(t) \; dt = \delta(k-k') \cdot \delta(l-l')\] <hr> <details><summary>Proof: Hopefully the construction is intuitive enough, but a detailed proof is given here.</summary> <p><br></p> <p>We need to show that \(\alpha_{(k,l)}(t)\) and \(\alpha_{(k', l')}(t)\) are orthogonal if \((k,l) \neq (k',l')\).</p> <p>Write</p> \[\begin{align*} \alpha_{(k,l)}(t) &amp;= \frac{\sqrt{T}}{\sqrt{MN}} \cdot \sum_{n=0}^{N-1} e^{j2 \pi \frac{k}{NT} nT} \cdot M \Delta f \cdot e^{j 2\pi \frac{M \Delta f}{2} (t- \frac{lT}{M} - nT)} \cdot \mathrm{sinc}\big(M \Delta f \cdot (t- \frac{lT}{M} - nT)\big) \end{align*}\] <p>The important fact that we need is</p> \[\begin{align*} &amp;\int_{-\infty} ^\infty a\cdot \mathrm{sinc}(a (t-\tau_1)) \cdot a \cdot \mathrm{sinc}(a(t-\tau_2)) \; dt\\ =&amp; a \cdot \mathrm{sinc}(a (t-\tau_1)) * a \cdot \mathrm{sinc}(a (t-\tau_2))\\ =&amp; a \cdot \mathrm{sinc}(a (\tau_1-\tau_2)) \end{align*}\] <p>Apply this with \(a = M\Delta f\), we have</p> \[\begin{align*} \langle \alpha_{(k,l)}, \alpha_{(k', l')}\rangle &amp;= \int_{-\infty}^\infty \alpha_{(k,l)}(t) \cdot \alpha^\dagger _{(k',l')}(t) \; dt\\ =&amp;\frac{T}{MN} \sum_{n_1=0}^{N-1} \sum_{n_2 = 0}^{N-1} e^{j2\pi \frac{n_1 k-n_2 k'}{N}} e^{j 2\pi \frac{M}{2} (\frac{l'-l}{M} + (n_2-n_1)) }\cdot (M\Delta f) \mathrm{sinc}\big( (l'-l) +M(n_2-n_1) \big) \end{align*}\] <p>The argument in the \(\mathrm{sinc}\) function is an integer, and the result is zero only when the argument is \(0\). Because \(l, l' \in [0, M-1]\), this happens if and only if \(l = l', n_1 = n_2\), which greatly simplifies the calculation. (This same orthogonality of sinc functions with some regular spaced delays is also used in the sampling theorem. ) Use this, we have:</p> \[\begin{align*} \langle \alpha_{(k,l)}, \alpha_{(k', l')}\rangle &amp;= \delta(l'-l) \cdot \frac{1}{N} \sum_{n=0}^{N-1} e^{j2\pi \frac{n(k-k')}{N}}\\ &amp;= \delta(l'-l) \cdot \delta(k'-k) \end{align*}\] <p>The last sum is the sum of samples of a sinusoid over \((k-k')\) cycles, which is also a frequently used fact.</p> </details> <p><br></p> <hr> <p>For the sake of the following discussion, we now define an approximate version of the above orthonormal basis. For convenience, we start with a new notation</p> \[g(t; A) \stackrel{\Delta}{=} \begin{cases} \frac{1}{\sqrt{A}} &amp; t \in [0, A) \\ 0 &amp; \mbox{otherwise} \end{cases}\] <p>which is the rectangle function over \([0,A)\) normalized to have unit power. Now we write from the definition</p> \[\begin{align*} \alpha_{(k,l)}(t) &amp;= \frac{\sqrt{T}}{\sqrt{MN}} \cdot \sum_{n=0}^{N-1} s \left(t - l \cdot \frac{T}{M} - nT \right) \cdot e^{j2\pi \frac{kn}{N}}\\ &amp;= \frac{\sqrt{M}}{\sqrt{NT}} \cdot \sum_{n=0}^{N-1} \mathrm{sinc}\left( \frac{M}{T} \cdot (t - l \frac{T}{M} - n T) \right) \cdot e^{j\pi (\frac{M}{T}\cdot (t - l\frac{T}{M} - nT))}\cdot e^{j2\pi \frac{kn}{N}} \\ &amp; \approx \frac{1}{\sqrt{N}} \cdot \sum_{n=0}^{N-1} g\left(t - l \frac{T}{N} - nT; \frac{T}{M}\right) \cdot e^{j\pi (\frac{M}{T}\cdot (t - l\frac{T}{M} - nT))}\cdot e^{j2\pi \frac{kn}{N}}\\ &amp; \stackrel{\Delta}{=} \tilde{\alpha}_{(k,l)}(t) \end{align*}\] <p>Roughly speaking, if we replace the sinc function in \(s(t)\), for which the main slobe has width \(\frac{1}{M\Delta f} = \frac{T}{M}\), with a rectangle function of the same width and the same unit power \(g(t; \frac{T}{M})\), we get a new set of ortho-normal basis. This gives an intuitive view of the basis: \(\alpha_{(k,l)}\), or approximately \(\tilde{\alpha}_{(k,l)}\) consists of \(N\) narrow impulses, with energy focused in the narrow time interval \([\frac{l}{M}T + nT, \frac{l+1}{M}T + nT)\), for \(l = 0, 1, \ldots, M-1, n=0, \ldots, N-1\). These \(N\) narrow impulses are shifted in phase with \(e^{j 2\pi \frac{kn}{N}}\) determined by \(k\).</p> <p><br></p> <h2 id="the-construction-of-the-otfs-modulation">The Construction of the OTFS Modulation</h2> <p>The following are the main steps to construct the OTFS modulation.</p> <ol> <li> <p>We can write every waveform in \(\Omega(NT, M\Delta f)\) as linear combinations of the orthonormal basis defined in the last section. We can potentially modulate information on these coefficients and transmit the corresponding waveform.</p> </li> <li> <p>For the same waveform, we will derive a map between this set of coefficients and the coefficients on other more familiar basis. This is clearly a linear map that can be thought as a change of basis. An easy implementation of this map allows us to turn the data symbols that we want to modulate on the DD-domain basis into the symbols that we can modulate on another basis, and thus construct a usable OTFS modulation system.</p> </li> </ol> <h3 id="otfs-modulation">OTFS Modulation</h3> <p>With the definition of the DD-Domain basis functions, it is natural to define new modulation scheme as</p> \[x(t) = \sum_{k=0}^{N-1}\sum_{l=0}^{M-1} x_{\mathsf{DD}}[k,l] \cdot \alpha_{(k,l)}(t)\] <p>where \(x_{\mathsf{DD}}[k,l], k=0, \ldots, N-1, l = 0, \ldots, M-1\) are \(MN\) independent digital symbols, multiplexed in one waveform. To demodulate these symbols, one can use \(\alpha_{(k,l)}(t)\) as the output matched filters to separate these data symbols. The point is that when there is only a few paths with different delays and Doppler-shifts that remain constant, the interference between these separate data symbols can be light.</p> <p>In comparison, the time-frequency domain modulation can be written as</p> \[x(t) = \sum_{n=0}^{N-1} \sum_{m=0}^{M-1} x_{\mathsf{TF}}[n, m] \cdot \beta_{(n, m)}(t)\] <p>where</p> \[\beta_{(n,m)}(t) = \frac{1}{\sqrt{MN}} g(t-nT; T) e^{j 2\pi m \Delta f (t-nT)}\] <p>with \(g(t; T) = \frac{1}{\sqrt{T}}\) for \(t \in [0, T)\). One can see that the set of functions \(\beta_{(n,m)}\) also forms an orthonormal basis of \(\Omega(NT, M\Delta f)\), and this more familiar form of T-F domain modulation is precisely what we do in OFDM, which is only a change of basis from OTFS.</p> <p>Now we need to write out this change of coordinate explicitly. We write this as the following Theorem</p> <hr> <dl> <dt>Theorem: Coordinate Change</dt> <dd>We have</dd> </dl> \[x_{\mathsf{TF}}[n,m] = \sum_{k=0}^{N-1}\sum_{l=0}^{M-1} x_{\mathsf{DD}}[k,l] \cdot e^{j2\pi (\frac{nk}{N} - \frac{ml}{M})}\] <p>and reversely</p> \[x_{\mathsf{DD}}[k,l] = \sum_{n=0}^{N-1}\sum_{m=0}^{M-1} x_{\mathsf{TF}}[n,m] \cdot e^{j2\pi (-\frac{nk}{N} + \frac{ml}{M})}\] <p>Proof: The key is to evaluate the inner product</p> \[\langle \alpha_{(k,l)} , \beta_{(n,m)}\rangle = e^{j2\pi (\frac{nk}{N} - \frac{ml}{M})}\] <p>which can now be evaluated in brute force.</p> <details><summary>We include the steps here.</summary> <p>The key is to realize that \(\alpha_{(k,l)}\) is time limited to \(N\) small intervals: \(\left[n'T + l\frac{T}{M}, n'T + (l+1)\frac{T}{M}\right]\) for \(n'=0, \ldots, N-1\), and \(\beta_{(n,m)}\) is also time limited to \([nT, (n+1)T]\). So there only a single sub-interval from the support of \(\alpha_{(k,l)}\) that overlap with \(\beta_{(n,m)}\). We can thus directly write the inner product as an interval within that interval.</p> \[\begin{align*} \langle \alpha_{(k,l)}, \beta_{(n,m)}\rangle &amp;= \int_{nT + l \frac{T}{M}}^{nT + (l+1)\frac{T}{M}} \; \alpha_{(k,l)}(t) \cdot \beta_{(n,m)}^\dagger (t) \; dt\\ &amp;= \int_{nT + l \frac{T}{M}}^{nT + (l+1)\frac{T}{M}} \; \sqrt{\frac{T}{MN}} s\left(t - l \frac{T}{M} - nT\right) \cdot e^{j2\pi \frac{kn}{N}} \cdot \frac{1}{\sqrt{MN}} g(t-nT; T) \cdot e^{-j2\pi \frac{m}{T}(t-nT)}\; dt \end{align*}\] <p>Now we can define \(u = t-l\frac{T}{m} - nT\), we can write</p> \[\begin{align*} \langle \alpha_{(k,l)}, \beta_{(n,m)}\rangle &amp;= \int_0^{\frac{T}{M}} \frac{\sqrt{T}}{MN} \cdot s(u) \cdot g\left(u+ l\frac{T}{M}; T\right) \cdot e^{-j2\pi \frac{m}{T} u} \; du \cdot e^{j2\pi \frac{kn}{N}} \cdot e^{-j2\pi \frac{ml}{M}} \end{align*}\] <p>Now we observe that \(g(t)\) is a rectangle function. Thus the time shift does not make any difference. The resulting integral remains a constant not depending on \(k,l,m,n\), which can be normalized later. We thus have proved</p> \[\langle \alpha_{(k,l)}, \beta_{(n,m)}\rangle \propto e^{j2\pi \frac{kn}{N}} \cdot e^{-j2\pi \frac{ml}{M}}\] <p>as desired.</p> </details> <p><br></p> <h2 id="the-sparsity-in-dd-domain-a-numerical-experiment">The Sparsity in DD-Domain, a Numerical Experiment</h2> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="https://blog.google/technology/ai/google-gemini-update-flash-ai-assistant-io-2024/" target="_blank" rel="external nofollow noopener">Google Gemini updates: Flash 1.5, Gemma 2 and Project Astra</a> <svg width="1rem" height="1rem" viewbox="0 0 30 30" xmlns="http://www.w3.org/2000/svg"> <path d="M17 13.5v6H5v-12h6m3-3h6v6m0-6-9 9" class="icon_svg-stroke" stroke="#999" stroke-width="1.5" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path> </svg> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="https://medium.com/@al-folio/displaying-external-posts-on-your-al-folio-blog-b60a1d241a0a?source=rss-17feae71c3c4------2" target="_blank" rel="external nofollow noopener">Displaying External Posts on Your al-folio Blog</a> <svg width="1rem" height="1rem" viewbox="0 0 30 30" xmlns="http://www.w3.org/2000/svg"> <path d="M17 13.5v6H5v-12h6m3-3h6v6m0-6-9 9" class="icon_svg-stroke" stroke="#999" stroke-width="1.5" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path> </svg> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/symbol-detection/">Symbol Detection in Wireless Communication</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/Side-Information/">Learning with Side Information</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/nested-H-score/">The Nested H-Score Network</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Lizhong Zheng. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>